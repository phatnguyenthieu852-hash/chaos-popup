<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8">
<title>ULTRA LOCK v2</title>
<style>
body{
 background:black;
 color:white;
 text-align:center;
 font-family:Arial;
 margin-top:60px;
}
button{padding:14px 20px;font-size:18px;margin:8px}
</style>
</head>
<body>

<h1>üëπ ULTRA LOCK v2</h1>
<button onclick="start()">START</button>
<button onclick="stopAll()">STOP</button>

<script>
const W=260,H=150;
const MAX_POP=25;
let pops=[];
let mouse={x:0,y:0},lastMouse={x:0,y:0};

document.addEventListener("mousemove",e=>{
 lastMouse=mouse;
 mouse={x:e.screenX,y:e.screenY};
 pops.forEach(p=>{
  try{p.postMessage({mouse,lastMouse},"*")}catch{}
 });
});

function popupHTML(){
return `
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=260,initial-scale=1,maximum-scale=1,user-scalable=no">
<style>
html,body{
 margin:0;
 padding:0;
 width:260px;
 height:150px;
 overflow:hidden;
 background:black;
 color:lime;
 text-align:center;
 font-family:Arial;
}
#t{margin-top:40px}
</style>
</head>
<body>
<h3 id="t">ULTRA LOCK v2</h3>

<script>
const W=260,H=150;
let mouse={x:0,y:0},lastMouse={x:0,y:0};

window.addEventListener("message",e=>{
 mouse=e.data.mouse||mouse;
 lastMouse=e.data.lastMouse||lastMouse;
});

// ‚úÖ kh√≥a size ƒë√∫ng c√°ch (kh√¥ng spam resize)
function lockSize(){
 try{
  if(
   window.innerWidth>W+40 ||
   window.innerHeight>H+40
  ){
   window.resizeTo(W,H);
  }
 }catch{}
}

// ch·ªâ resize khi load xong
window.addEventListener("load",()=>{
 setTimeout(()=>{
  try{window.resizeTo(W,H)}catch{}
 },120);
});

// kh√≥a ch·∫≠m ‚Üí tr√°nh bug Chrome
setInterval(lockSize,500);

// ch·∫∑n fullscreen API
document.addEventListener("fullscreenchange",()=>{
 try{document.exitFullscreen()}catch{}
});

// üß† n√© chu·ªôt d·ª± ƒëo√°n
setInterval(()=>{
 let sx=window.screenX;
 let sy=window.screenY;
 let vx=mouse.x-lastMouse.x;
 let vy=mouse.y-lastMouse.y;
 let px=mouse.x+vx*4;
 let py=mouse.y+vy*4;
 let dx=sx-px;
 let dy=sy-py;
 let nx=sx+(Math.random()*100-50);
 let ny=sy+(Math.random()*100-50);
 if(Math.hypot(dx,dy)<240){
  nx=sx+dx*1.5;
  ny=sy+dy*1.5;
 }
 try{
  window.moveTo(
   Math.max(0,Math.min(screen.availWidth-W,nx)),
   Math.max(0,Math.min(screen.availHeight-H,ny))
  );
 }catch{}
},80);

// üîä n√≥i nh·∫π
setInterval(()=>{
 try{
  const words=["ai h·ªèi","gah dayumüíîü•Ä","ULTRA LOCK"];
  let u=new SpeechSynthesisUtterance(
   words[Math.floor(Math.random()*words.length)]
  );
  speechSynthesis.speak(u);
 }catch{}
},2500);

<\/script>
</body>
</html>
`;
}

function createPopup(){
 if(pops.length>=MAX_POP)return;
 const p=window.open(
  "",
  "",
  "popup=yes,width=260,height=150,left=120,top=120,resizable=no,scrollbars=no,menubar=no,toolbar=no"
 );
 if(!p)return;
 p.document.write(popupHTML());
 pops.push(p);
}

function start(){
 for(let i=0;i<5;i++)createPopup();
 window._loop=setInterval(createPopup,8000);
}

function stopAll(){
 clearInterval(window._loop);
 pops.forEach(p=>{try{p.close()}catch{}});
 pops=[];
}
</script>

</body>
</html>
