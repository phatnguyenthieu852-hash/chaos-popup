<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8">
<title>CHAOS GOD â€” FUN MODE</title>
<style>
body{background:#000;color:#fff;text-align:center;font-family:Arial;margin-top:60px}
button{padding:14px 20px;font-size:18px;margin:8px}
</style>
</head>
<body>

<h1>ðŸŽª CHAOS GOD â€” FUN MODE</h1>
<button onclick="start()">START CHAOS</button>
<button onclick="stopAll()">STOP</button>

<script>
const W=260,H=150, MAX_POP=60;
let pops=[];
let mouse={x:0,y:0}, lastMouse={x:0,y:0};

document.addEventListener("mousemove",e=>{
  lastMouse=mouse;
  mouse={x:e.screenX,y:e.screenY};
  pops.forEach(p=>{ try{p.postMessage({type:"mouse",mouse,lastMouse},"*")}catch{} });
});

function popupHTML(isBoss=false){
return `
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=260, initial-scale=1, maximum-scale=1, user-scalable=no">
<style>
html,body{margin:0;width:260px;height:150px;overflow:hidden;background:#000;color:#0f0;
  text-align:center;font-family:Arial;touch-action:none}
#t{margin-top:36px;font-size:18px}
</style>
</head>
<body>
<h3 id="t">${isBoss ? "ðŸ‘‘ CHAOS BOSS" : "CHAOS POP"}</h3>

<script>
const W=260,H=150;
let mouse={x:0,y:0}, lastMouse={x:0,y:0};

// ðŸ”’ khÃ³a size chá»‘ng fullscreen
setInterval(()=>{
  try{
    if(document.fullscreenElement) document.exitFullscreen();
    if(window.outerWidth!==W || window.outerHeight!==H) window.resizeTo(W,H);
  }catch{}
},120);

window.addEventListener("message",e=>{
  if(e.data?.type==="mouse"){
    mouse=e.data.mouse||mouse;
    lastMouse=e.data.lastMouse||lastMouse;
  }
  if(e.data?.type==="boss-command"){
    // boss ra lá»‡nh teleport
    try{
      window.moveTo(Math.random()*(screen.availWidth-W),
                    Math.random()*(screen.availHeight-H));
    }catch{}
  }
});

// ðŸŽ¨ Ä‘á»•i chá»¯ + mÃ u
setInterval(()=>{
  const words=["ai há»i","gah dayumðŸ’”ðŸ¥€","CHAOS","ERROR","LOL"];
  const el=document.getElementById("t");
  el.innerText=words[Math.floor(Math.random()*words.length)];
  document.body.style.background="hsl("+Math.random()*360+",80%,20%)";
},250);

// ðŸ§  Ä‘uá»•i â€“ nÃ© â€“ dá»± Ä‘oÃ¡n
setInterval(()=>{
  let sx=window.screenX, sy=window.screenY;
  let vx=mouse.x-lastMouse.x, vy=mouse.y-lastMouse.y;
  let px=mouse.x+vx*4, py=mouse.y+vy*4; // dá»± Ä‘oÃ¡n
  let dx=sx-px, dy=sy-py;
  let nx=sx+(Math.random()*140-70);
  let ny=sy+(Math.random()*140-70);
  if(Math.hypot(dx,dy)<260){ nx=sx+dx*1.6; ny=sy+dy*1.6; }
  try{
    window.moveTo(
      Math.max(0,Math.min(screen.availWidth-W,nx)),
      Math.max(0,Math.min(screen.availHeight-H,ny))
    );
  }catch{}
},55);

// ðŸ”¥ click trÆ°á»£t â†’ xin spawn thÃªm
document.addEventListener("click",()=>{
  if(window.opener){
    window.opener.postMessage({type:"miss"}, "*");
  }
});

// ðŸ”Š nÃ³i loáº¡n
setInterval(()=>{
  try{
    const words=["ai há»i","gah dayumðŸ’”ðŸ¥€","CHAOS GOD"];
    let u=new SpeechSynthesisUtterance(words[Math.floor(Math.random()*words.length)]);
    let v=speechSynthesis.getVoices();
    if(v.length)u.voice=v[Math.floor(Math.random()*v.length)];
    speechSynthesis.speak(u);
  }catch{}
},2000);

// ðŸ‘‘ boss: thá»‰nh thoáº£ng ra lá»‡nh cho Ä‘Ã n
${isBoss ? `
setInterval(()=>{
  if(window.opener){
    window.opener.postMessage({type:"boss-broadcast"}, "*");
  }
},5000);
` : ``}

<\/script>
</body>
</html>
`;
}

function createPopup(isBoss=false){
  if(pops.length>=MAX_POP) return;
  const p=window.open(
    "",
    "",
    "popup=yes,width=260,height=150,left=120,top=120,resizable=no,menubar=no,toolbar=no,location=no,status=no,scrollbars=no"
  );
  if(!p) return;
  try{
    p.document.open();
    p.document.write(popupHTML(isBoss));
    p.document.close();
  }catch{}
  pops.push(p);
}

window.addEventListener("message",e=>{
  if(e.data?.type==="miss"){ createPopup(false); }
  if(e.data?.type==="boss-broadcast"){
    // boss ra lá»‡nh teleport cho táº¥t cáº£ popup con
    pops.forEach(p=>{ try{p.postMessage({type:"boss-command"},"*")}catch{} });
  }
});

function start(){
  createPopup(true); // boss
  for(let i=0;i<8;i++) createPopup(false);
  window._loop=setInterval(()=>createPopup(false),6000);
}

function stopAll(){
  clearInterval(window._loop);
  pops.forEach(p=>{ try{p.close()}catch{} });
  pops=[];
}
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8">
<title>CHAOS GOD â€” FUN MODE</title>
<style>
body{background:#000;color:#fff;text-align:center;font-family:Arial;margin-top:60px}
button{padding:14px 20px;font-size:18px;margin:8px}
</style>
</head>
<body>

<h1>ðŸŽª CHAOS GOD â€” FUN MODE</h1>
<button onclick="start()">START CHAOS</button>
<button onclick="stopAll()">STOP</button>

<script>
const W=260,H=150, MAX_POP=60;
let pops=[];
let mouse={x:0,y:0}, lastMouse={x:0,y:0};

document.addEventListener("mousemove",e=>{
  lastMouse=mouse;
  mouse={x:e.screenX,y:e.screenY};
  pops.forEach(p=>{ try{p.postMessage({type:"mouse",mouse,lastMouse},"*")}catch{} });
});

function popupHTML(isBoss=false){
return `
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=260, initial-scale=1, maximum-scale=1, user-scalable=no">
<style>
html,body{margin:0;width:260px;height:150px;overflow:hidden;background:#000;color:#0f0;
  text-align:center;font-family:Arial;touch-action:none}
#t{margin-top:36px;font-size:18px}
</style>
</head>
<body>
<h3 id="t">${isBoss ? "ðŸ‘‘ CHAOS BOSS" : "CHAOS POP"}</h3>

<script>
const W=260,H=150;
let mouse={x:0,y:0}, lastMouse={x:0,y:0};

// ðŸ”’ khÃ³a size chá»‘ng fullscreen
setInterval(()=>{
  try{
    if(document.fullscreenElement) document.exitFullscreen();
    if(window.outerWidth!==W || window.outerHeight!==H) window.resizeTo(W,H);
  }catch{}
},120);

window.addEventListener("message",e=>{
  if(e.data?.type==="mouse"){
    mouse=e.data.mouse||mouse;
    lastMouse=e.data.lastMouse||lastMouse;
  }
  if(e.data?.type==="boss-command"){
    // boss ra lá»‡nh teleport
    try{
      window.moveTo(Math.random()*(screen.availWidth-W),
                    Math.random()*(screen.availHeight-H));
    }catch{}
  }
});

// ðŸŽ¨ Ä‘á»•i chá»¯ + mÃ u
setInterval(()=>{
  const words=["ai há»i","gah dayumðŸ’”ðŸ¥€","CHAOS","ERROR","LOL"];
  const el=document.getElementById("t");
  el.innerText=words[Math.floor(Math.random()*words.length)];
  document.body.style.background="hsl("+Math.random()*360+",80%,20%)";
},250);

// ðŸ§  Ä‘uá»•i â€“ nÃ© â€“ dá»± Ä‘oÃ¡n
setInterval(()=>{
  let sx=window.screenX, sy=window.screenY;
  let vx=mouse.x-lastMouse.x, vy=mouse.y-lastMouse.y;
  let px=mouse.x+vx*4, py=mouse.y+vy*4; // dá»± Ä‘oÃ¡n
  let dx=sx-px, dy=sy-py;
  let nx=sx+(Math.random()*140-70);
  let ny=sy+(Math.random()*140-70);
  if(Math.hypot(dx,dy)<260){ nx=sx+dx*1.6; ny=sy+dy*1.6; }
  try{
    window.moveTo(
      Math.max(0,Math.min(screen.availWidth-W,nx)),
      Math.max(0,Math.min(screen.availHeight-H,ny))
    );
  }catch{}
},55);

// ðŸ”¥ click trÆ°á»£t â†’ xin spawn thÃªm
document.addEventListener("click",()=>{
  if(window.opener){
    window.opener.postMessage({type:"miss"}, "*");
  }
});

// ðŸ”Š nÃ³i loáº¡n
setInterval(()=>{
  try{
    const words=["ai há»i","gah dayumðŸ’”ðŸ¥€","CHAOS GOD"];
    let u=new SpeechSynthesisUtterance(words[Math.floor(Math.random()*words.length)]);
    let v=speechSynthesis.getVoices();
    if(v.length)u.voice=v[Math.floor(Math.random()*v.length)];
    speechSynthesis.speak(u);
  }catch{}
},2000);

// ðŸ‘‘ boss: thá»‰nh thoáº£ng ra lá»‡nh cho Ä‘Ã n
${isBoss ? `
setInterval(()=>{
  if(window.opener){
    window.opener.postMessage({type:"boss-broadcast"}, "*");
  }
},5000);
` : ``}

<\/script>
</body>
</html>
`;
}

function createPopup(isBoss=false){
  if(pops.length>=MAX_POP) return;
  const p=window.open(
    "",
    "",
    "popup=yes,width=260,height=150,left=120,top=120,resizable=no,menubar=no,toolbar=no,location=no,status=no,scrollbars=no"
  );
  if(!p) return;
  try{
    p.document.open();
    p.document.write(popupHTML(isBoss));
    p.document.close();
  }catch{}
  pops.push(p);
}

window.addEventListener("message",e=>{
  if(e.data?.type==="miss"){ createPopup(false); }
  if(e.data?.type==="boss-broadcast"){
    // boss ra lá»‡nh teleport cho táº¥t cáº£ popup con
    pops.forEach(p=>{ try{p.postMessage({type:"boss-command"},"*")}catch{} });
  }
});

function start(){
  createPopup(true); // boss
  for(let i=0;i<8;i++) createPopup(false);
  window._loop=setInterval(()=>createPopup(false),6000);
}

function stopAll(){
  clearInterval(window._loop);
  pops.forEach(p=>{ try{p.close()}catch{} });
  pops=[];
}
</script>

</body>
</html>
